# 0411 django



## 인증모델



'django.contrib.auth' - 인증 프레임워크의 기본모델

/ 'django.contrib.contenttype' - 사용자가 생성한 모델과 권한을 연결

인증시스템을 하기 위해 앱 'accounts'를 생성, 이 이름으로 안할 수는 있지만, 내부적으로 accounts로 연결되어 있는 부분이 많음



## 쿠키와 세션

http는 비연결지향이라 요청에 대한 응답을 보낸 후 연결을 끊음

연결을 끊는 순간 상태 정보가 유지되지 않음, 즉 클라이언트와 서버의 지속적인 관계를 유지하기 위한 방책이 필요함.

### 쿠키(브라우저에 저장)

- 서버가 사용자의 웹 브라우저에 전송하는 데이터 조각이나, 이를 클라이언트에 배치되어 이후 서버에 재요청시 배치된 기록파일인 쿠키를 함께 전송/ 실행 파일 절대 아님!
- 상태가 있는 세션을 만들어주는 역할/ 보통 장바구니에서 많이 사용
- 한번 쿠키가 발급되면 그 사이트 접근시 무조건 전송-안 보내고 싶은데 무조건 보내야 하는 상황
- 세션 관리, 개인화(사용자 선호, 테마), 트래킹

### 세션(세션테이블을 서버가 관리)

- 사이트와 특정 브라우저 사이의 상태 유지
- 서버가 특정 세션 id 발급, 이를 클라이언트는 쿠키에 저장
- id는 세션을 구별하기 위해 필요, 쿠키에는 id만 저장
- 수명은 크게 session cookies(현재 세션이 종료되면 삭제)와 persistent cookies(expire date에 정의된 시기까지 저장되어 있음)으로 나뉘어짐
- django의 세션은 미들웨어를 통해 구현/database-backed sessions 저장 방식 - DB의 django_session 테이블에 저장
- sessionmiddleware(요청 전반에 걸쳐 세션 관리)/ authenticationmiddleware(세션을 이용하여 사용자를 요청과 연결)

## 로그인

- 장고는 기본적으로 로그인을 세션을 만드는 과정으로 설계, 빌트인이 이미 되어 있음
- Authenticationform은 modelform이 아니라 form(첫 번째 인자가 request)에 상속을 받음
- Authenticationform은 사전 인증 절차일 뿐, 로그인을 직접 구현하는 건 ""로그인 함수"
- 이는 아이디와 패스워드가 데이터베이스에 저장되는 회원가입이 아니라, 그냥 인증에서 사용하는 데이터일 뿐임
- makemigrations - installed_apps에 있는 앱에 대해 makemigrations